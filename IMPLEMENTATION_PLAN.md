# Gas Distributor Project Implementation Plan

This document outlines the step-by-step plan to complete the Gas Distributor project, moving from the current state to a fully functional application as described in the README.

## 1. Current Status Assessment

*   **Authentication:** Functional (Signup, Login, Roles: User/Admin/Superadmin).
*   **Database:** Models exist for core entities. Seeding for Admin/Superadmin is implemented.
*   **Backend Structure:** Routes exist but some are not mounted (`dashboard`, `organization`, `product`). Controllers for `users` and `token` are stubs or incomplete.
*   **Frontend:** Basic Auth pages and dynamic User Dashboard exist. SuperAdmin Dashboard is a placeholder. Outlet Dashboard is missing.

## 2. Implementation Phases

### Phase 1: Backend Core & Routing Repair ✅ COMPLETED
**Goal:** Ensure all API endpoints are accessible and core logic for Requests and Users is in place.

1.  **Mount Missing Routes:** ✅ Done - Added `dashboard`, `organization`, `product` routes in `app.js`.
2.  **Implement User Controller:** ✅ Done - Added `getProfile` and `getUserRequests` in `users.controller.js`.
3.  **Fix Token/Request Logic:** ✅ Done - Updated `requestToken` to securely get `consumerId` from `req.user._id`, validate `outletId` exists, link Token to Request.

**Testing:** ✅ Verified `GET /api/v1/users/profile` and `GET /api/v1/users/requests` work correctly with JWT auth.

### Phase 2: Super Admin Dashboard (Organization Management) ✅ COMPLETED
**Goal:** Allow Super Admin to manage the system's entities.

1.  **Backend:** ✅ Done - Added `getAllUsers`, `createOutlet`, `getAllOutlets`, `updateOutlet`, `deleteOutlet` in `admin.controller.js`.
2.  **Frontend:** ✅ Done - Updated `SuperAdmindash.jsx` with Users tab (list + promote/demote) and Outlets tab (list + create form).

**Testing:** ✅ Verified backend endpoints return data correctly. Frontend build successful with updated UI.

### Phase 3: Outlet Management (Supply Side)
**Goal:** Enable Outlet managers to handle stock and fulfill requests.

1.  **Backend (`backend/controllers/outlet.controller.js`):**
    *   `getOutletStock`: Return current gas stock levels.
    *   `updateStock`: Add/Remove stock.
    *   `getPendingRequests`: List requests assigned to this outlet.
    *   `validateToken`: Verify a token provided by a user and mark the request as "Fulfilled".
2.  **Frontend (`src/Pages/Outlet/OutletDash.jsx`):**
    *   Create this new component.
    *   **Requests Tab:** List pending requests.
    *   **Fulfillment Tab:** Input field for Token ID -> Verify -> Complete.
    *   **Stock Tab:** View and update inventory.

### Phase 4: Consumer Experience (Demand Side)
**Goal:** Allow users to request gas and track status.

1.  **Frontend (`src/Pages/Userdash.jsx`):**
    *   **Request Gas:** Add a form/modal to select Gas Type, Quantity, and Outlet.
    *   **My Requests:** Fetch and display list of requests.
    *   **Token Display:** If a request is approved, show the Token (Code/QR).

### Phase 5: Notifications & Polish
**Goal:** Improve user feedback and UI.

1.  **Notifications:**
    *   Implement `notification.controller.js` to create alerts when Request Status changes (Pending -> Approved -> Delivered).
    *   Display notifications in the Frontend Navbar.
2.  **UI Polish:**
    *   Ensure consistent Tailwind styling.
    *   Add loading states and error handling (Toast notifications).

## 3. Immediate Next Steps (Actionable)

1.  **Phase 3:** Start with Backend - Implement outlet stock and request management in `outlet.controller.js`.
2.  **Phase 3:** Create `OutletDash.jsx` for outlet managers to handle stock and fulfill requests.
3.  **Phase 4:** Update `Userdash.jsx` to allow requesting gas and viewing tokens.

---
*Generated by GitHub Copilot*
